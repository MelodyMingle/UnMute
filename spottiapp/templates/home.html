
{% extends "base.html" %}

{% block content %}
<!-- <div class="flex flex-row">

    <div class=" mx-auto bg-green-400">
        
        
        <button onclick="authenticateSpotify()">Authenticate Spotify</button>
        <button onclick="searchTrack()">Search Spotify</button>
        <button onclick="searchPlaylist()">Search Spotify Playlist</button>
    </div>
</div> -->

<div>

    
    <h1 class="bg-green-400">Post</h1>
    
    
    <ul >
        {% for post in object_list %}
        <div class="bg-slate-600">
            
            <li> <a href="{% url 'article-detail' post.pk %}">{{ post.title}}</a> - {{ post.author}} - {{ post.post_date }}  
                {% if post.author == user %}
                - <a href="{% url 'update_post' post.pk %}">(Edit)</a> -  <a href="{% url 'delete_post' post.pk %}">(Delete)</a>
                {% endif %}
            </div>
            {{ post.comment|slice:":200"|safe}}
        </li>
    {% endfor %}
</ul>
</div>

<script>
    function authenticateSpotify() {
        fetch("/spotify/is-authenticated")
        .then((response) => {
            console.log(response)
            return response.json()})
         .then((response)=>{
            console.log(response)
            if(response.status == false){
                window.location.replace('spotify/get-auth-url')
            }
         })
    }

    function searchTrack(){
        fetch("/spotify/search?query=trouble")
        .then((response)=>{
            console.log(response)
            return response.json();
        })
        .then(data => console.log(data))
    }

    function searchPlaylist(){
        fetch("/spotify/playlists")
        .then((response)=>{
            console.log(response)
            return response.json();
        })
        .then(data => console.log(data))
    }
    </script>

{% endblock content %}

