{% extends "base.html" %}

{% block content %}

<!-- <button onclick="authenticateSpotify()">Authenticate Spotify</button>
<button onclick="searchTrack()">Search Spotify</button>
<button onclick="searchPlaylist()">Search Spotify Playlist</button> -->
<button onclick="searchPlaylist()">Search Spotify Playlist</button>

<h1 class="bg-green-400">Post</h1>

<h1>Playlist Data</h1>
<ul>
    {% for playlist in playlists %}
        <li>
            <strong>Name:</strong> {{ playlist.name }}<br>
            <strong>Description:</strong> {{ playlist.description }}<br>
            <strong>Owner:</strong> {{ playlist.owner }}<br>
            <strong>Total Tracks:</strong> {{ playlist.tracks_total }}<br>
            <strong>URL:</strong> <a href="{{ playlist.url }}">{{ playlist.url }}</a><br>
            {% if playlist.image %}
                <img src="{{ playlist.image }}" alt="Playlist Image" height="300" width="300"><br>
            {% endif %}
            <table>
                {% if user.is_authenticated %}
                <div class="form-group ">
                    <h2 class="mb-4 text-2xl font-bold">Add comment</h2>
                    <form method="POST" class="space-y-4 ">
                        {{ form.as_table }}
                        {% csrf_token %}
                    </table>
                    <button class="px-4 py-2 text-white bg-blue-500 rounded" type="submit">Add comment</button>
                </form>
            </div>
            
            {% else %}
            Ye shall not make any comments, please register, don't be a stranger
            {% endif %}
        </li>
        
    {% endfor %}
</ul>





<script>
    function authenticateSpotify() {
        fetch("/spotify/is-authenticated")
          .then(response => response.json())
          .then(response => {
            console.log(response);
            if (!response.status) {
                window.location.replace('spotify/get-auth-url');
            }
        });
    }
    function searchPlaylist() {
    fetch("/spotify/playlists/", {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')  // Function to get CSRF token
        },
        body: JSON.stringify({})  // Include any data you want to send
    })
    .then(response => response.json())
    .then(response => {
        console.log(response);
    });
}


</script>


{% endblock content %}
